<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANTIPOST GALLERY</title>
    <style>
        /* 1. DEKLARASI CUSTOM FONTS */
        @font-face {
            font-family: 'font1';
            src: url('/font/font1.ttf') format('truetype');
        }
        @font-face {
            font-family: 'font2';
            src: url('/font/font2.otf') format('opentype');
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        .nav-link {
            text-decoration: none; /* Hilangkan garis bawah biru khas link */
            color: inherit;
        }

        /* Supaya ketika di klik tidak ada delay/loncatan instan */
        .section-divider, .section-divider-block {
            scroll-margin-top: 110px; /* Sesuai dengan tinggi header kamu agar tidak tertutup */
        }
        
        body { 
            font-family: Arial, sans-serif; 
            background-color: white; 
            overflow-x: hidden; /* Tetap pertahankan */
            padding-top: 110px;
            width: 100%;
            position: relative;
            max-width: 100%; /* Tambahkan ini */
        }

        /* HEADER DESKTOP */
        header {
            background-color: #000000; padding: 20px 40px; display: flex; justify-content: center;
            align-items: center; position: fixed; top: 0; left: 0; width: 100%; z-index: 5000; height: 110px;
        }

        .nav-container { display: flex; gap: 50px; }
        .nav-item { 
            font-family: 'font1', sans-serif; 
            color: white; font-size: 16px; font-weight: normal; letter-spacing: 2px; cursor: pointer; 
        }
        
        .logo { 
            font-family: 'font2', sans-serif; 
            right: 40px; text-align: right; letter-spacing: 1px; font-size: 20px; line-height: 1.1; 
            color: white; position: absolute; z-index: 5001;
        }

        .logo2 { left: 25px; color: white; position: absolute; z-index: 5001; cursor: pointer; }
        .logo2 img { height: 100px; width: auto; }

        /* BIG LOGO */
        .biglogo-container { 
            display: flex; justify-content: center; align-items: center; 
            padding: 50px 150px; background-color: white; position: relative; z-index: 1; 
        }
        
        .biglogo-wrapper {
            position: relative;
            display: inline-block;
            max-width: 1200px;
        }

        .layer-base { width: 100%; height: auto; display: block; }

        #parallax-logo { 
            width: 100%; 
            height: auto; 
            display: block;
            will-change: transform; 
        }

        #parallax-insert {
            position: absolute;
            top: 50%;
            left: 65%;
            height: 45%; 
            width: auto;
            z-index: 2;
            transform-origin: center center;
            will-change: transform;
        }

        .layer-top {
            position: absolute;
            top: 0; 
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            clip-path: inset(0 0 0 55%); 
            pointer-events: none;
        }

        /* SECTION DIVIDERS */
        .section-divider {
            font-family: 'font2', sans-serif; 
            display: flex; justify-content: space-between; align-items: center; padding: 30px 40px;
            position: sticky; top: 110px; 
            z-index: 1000; 
            background-color: white; 
            box-shadow: 0 30px 30px white, 0 15px 15px rgba(0,0,0,0.05); 
            margin-top: -1px;
            transform: translateZ(0); 
            -webkit-transform: translateZ(0);
        }

        .section-divider-block {
            font-family: 'font2', sans-serif; 
            display: flex; justify-content: space-between; align-items: center; padding: 30px 40px;
            position: sticky; top: 110px; 
            z-index: 2000; 
            background-color: white; 
            border-top: none;
            margin-top: -1px;
        }
        .section-divider-block.is-pinned {
            background-color: black !important;
            color: white !important;
            border-bottom: 1px solid #333; /* Opsional: beri garis tipis supaya tidak mati */
        }

        .section-title, .section-title-block { font-size: 28px; letter-spacing: 2px; }
        .section-subtitle, .section-subtitle-block { font-size: 14px; text-align: right; line-height: 1.2; }
        .section-divider-block.is-pinned .section-title-block,
        .section-divider-block.is-pinned .section-subtitle-block {
            color: white !important;
        }

        /* GALLERY GRID */
        .image-gallery { 
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding: 40px; 
            background-color: white; margin-bottom: 80px; position: relative; z-index: 5; 
        }
        .image-gallery img { width: 100%; aspect-ratio: 4/5; object-fit: cover; border: 1px solid #eee; transition: transform 0.3s ease; cursor: zoom-in; }

        /* INFO SECTION */
        .info-container {
            background-color: black;
            color: white;
            padding: 100px 40px 0px 40px;
            display: flex;
            justify-content: space-between;
            gap: 30px;
            align-items: flex-start;
            position: relative;
            z-index: 2000;
        }

        .info-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .col-your { margin-top: 0; }
        .col-poster { margin-top: 100px; }
        .col-maker { margin-top: 200px; }

        .info-header {
            font-family: 'font2', sans-serif;
            font-size: clamp(40px, 8vw, 90px);
            line-height: 0.9;
            text-transform: uppercase;
        }

        .info-list {
            font-family: 'font1', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* --- FOOTER BLEEDING --- */
        .footer-banner-container {
            background-color: black;
            width: 100%;
            height: 200px; 
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            z-index: 2000;
            margin-top: -1px;
        }

        .footer-banner-container img {
            width: 103%; 
            height: auto;
            display: block;
            transform: translateY(85px); 
        }

        /* MODAL */
        #image-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.95); z-index: 6000; justify-content: center; align-items: center;
            flex-direction: column; overflow: hidden; touch-action: none;
        }
        .modal-container { 
            position: relative; display: flex; justify-content: center; align-items: center; 
            width: 100%; height: 80vh; overflow: hidden; cursor: grab; 
        }
        #modal-img { 
            max-width: 90%; max-height: 90%; border: 5px solid white; object-fit: contain; 
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            user-select: none; -webkit-user-drag: none;
        }
        #modal-img.zoomed { transform: scale(2.5); cursor: move; }
        #modal-caption { font-family: 'font2', sans-serif; color: white; margin-top: 20px; font-size: 20px; text-transform: uppercase; }
        #close-modal { position: absolute; top: 30px; right: 40px; color: white; font-size: 40px; cursor: pointer; z-index: 6005; }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            header { height: 85px; padding: 10px 30px; }
            body { padding-top: 85px; }
            .section-divider, .section-divider-block { top: 85px; padding: 15px 30px; }
            .logo2 img { height: 65px; }
            .logo { font-size: 13px; right: 28px; max-width: 100px; letter-spacing: 0.5px; }
            .section-title { font-size: 15px; }
            .section-subtitle { font-size: 9px; }
            .nav-container { display: none !important; } 
            .image-gallery { grid-template-columns: repeat(2, 1fr); padding: 20px; }
            .biglogo-container { padding: 60px 20px; }
            .info-container { flex-direction: column; padding: 60px 40px 40px 40px; gap: 60px; width: 100% !important; max-width: 100% !important; /* Paksa ke 100% bukan 100vw */ overflow: hidden; box-sizing: border-box;}
            .col-poster, .col-maker { margin-top: 0; }
            .info-header { font-size: 50px; }
            .footer-banner-container { width: 100%; padding: -50px 0px; overflow: hidden; margin-top: 0px; height: auto; display: block; }
            .footer-banner-container img { width: 150%; height: auto; display: block; transform: translateY(0); margin-bottom: -5px; margin: 0 auto; }

        }
    </style>
</head>
<body>

    <header>
        <a href="#" id="back-to-top" class="logo2"><img src="images/img/logo.gif" alt="Logo"></a>
        <nav class="nav-container">
            <a href="#artwork-section" class="nav-link"><div class="nav-item">[ WORKS ]</div></a>
            <a href="#commission-gallery-section" class="nav-link"><div class="nav-item">[ ARTWORK ]</div></a>
            <a href="#info-section" class="nav-link"><div class="nav-item">[ INFO ]</div></a>
        </nav>
        <div class="logo">CREATIVE<br>DESIGNER</div>
    </header>

    <div class="biglogo-container">
        <div class="biglogo-wrapper">
            <img src="images/img/biglogo.png" alt="Big Logo" class="layer-base" id="parallax-logo">
            <img src="images/img/logo2.png" alt="Rotating Logo" id="parallax-insert">
            <img src="images/img/biglogo2.png" alt="Big Logo Top" class="layer-top" id="parallax-logo-top">
        </div>
    </div>

    <div class="section-wrapper">
        <div id="artwork-section" class="section-divider">
            <div class="section-title">ARTWORKS</div>
            <div class="section-subtitle">MY PERSONAL<br>ARTWORKS</div>
        </div>
        <div id="image-gallery" class="image-gallery"></div>
        <div id="commission-gallery-section" class="section-divider">
            <div class="section-title">CLIENT WORKS</div>
            <div class="section-subtitle">MY RECENT<br>WORKS</div>
        </div>
        <div id="commission-gallery" class="image-gallery"></div>
        <div id="info-section" class="section-divider-block">
            <div class="section-title-block">INFO</div>
            <div class="section-subtitle-block">CONTACT<br>ME</div>
        </div>

        <div class="info-container">
            <div class="info-column col-your">
                <div class="info-header">YOUR</div>
                <div class="info-list">
                    <div>WE WORK</div>
                    <div>IN GRUNGE/DIRTY</div>
                    <div>(SOMETIMES CLEAN)</div>
                    <div>STYLE.</div>
                </div>
            </div>
            <div class="info-column col-poster">
                <div class="info-header">POSTER</div>
                <div class="info-list">
                    <div>POSTER</div>
                    <div>BAND/BRAND LOGO</div>
                    <div>COVER ART</div>
                    <div>MERCH</div>
                </div>
            </div>
            <div class="info-column col-maker">
                <div class="info-header">MAKER</div>
                <div class="info-list">
                    <div>IG</div>
                    <div>TIKTOK</div>
                    <div>EMAIL</div>
                </div>
            </div>
        </div>

        <div class="footer-banner-container">
            <img src="images/img/footer.png" alt="ANTIPOST GALLERY">
        </div>
    </div>

    <div id="image-modal">
        <span id="close-modal">&times;</span>
        <div class="modal-container" id="modal-container">
            <img id="modal-img" src="" alt="">
        </div>
        <div id="modal-caption"></div>
    </div>

    <script>
        // PARALLAX LOGIC
        function updateParallax() {
            const scrollY = window.pageYOffset;
            const bigLogo = document.getElementById('parallax-logo');
            const bigLogoTop = document.getElementById('parallax-logo-top');
            const insertLogo = document.getElementById('parallax-insert');
            const movement = scrollY * 0.4;
            const rotation = scrollY * 0.8;

            if (bigLogo) bigLogo.style.transform = `translateY(${movement}px)`;
            if (bigLogoTop) bigLogoTop.style.transform = `translateY(${movement}px)`;
            if (insertLogo) {
                insertLogo.style.transform = `translate(-50%, calc(-50% + ${movement}px)) rotate(${rotation}deg)`;
            }
            requestAnimationFrame(updateParallax);
        }
        requestAnimationFrame(updateParallax);

        // CLOUDINARY OPTIMIZER
        function optimizeCloudinary(url, mode = 'thumb') {
            if (!url.includes('cloudinary.com')) return url;
            const params = mode === 'thumb' ? 'f_auto,q_auto,w_600,h_750,c_fill' : 'f_auto,q_auto';
            return url.replace('/upload/', `/upload/${params}/`);
        }

        // --- MODAL FEATURES LOGIC ---
        const modal = document.getElementById('image-modal');
        const modalImg = document.getElementById('modal-img');
        const modalCont = document.getElementById('modal-container');
        let isZoomed = false;
        let isDragging = false;
        let startX, startY, translateX = 0, translateY = 0;

        function openView(src, title) {
            modal.style.display = "flex";
            modalImg.src = src;
            document.getElementById('modal-caption').innerHTML = title;
            document.body.style.overflow = "hidden";
            resetZoom();
        }

        function resetZoom() {
            isZoomed = false;
            isDragging = false;
            translateX = 0; translateY = 0;
            modalImg.classList.remove('zoomed');
            modalImg.style.transform = `translate(0px, 0px) scale(1)`;
            modalCont.style.cursor = 'grab';
        }

        // Zoom Click
        modalImg.addEventListener('click', (e) => {
            e.stopPropagation();
            isZoomed = !isZoomed;
            if (isZoomed) {
                modalImg.classList.add('zoomed');
                modalImg.style.transform = `scale(2.5)`;
                modalCont.style.cursor = 'move';
            } else {
                resetZoom();
            }
        });

        // Drag Logic
        modalCont.addEventListener('mousedown', e => {
            if (!isZoomed) return;
            isDragging = true;
            modalCont.style.cursor = 'grabbing';
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
        });

        window.addEventListener('mousemove', e => {
            if (!isDragging || !isZoomed) return;
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            modalImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(2.5)`;
        });

        window.addEventListener('mouseup', () => {
            isDragging = false;
            if(isZoomed) modalCont.style.cursor = 'move';
        });

        // Close functions
        function closeModal() { 
            modal.style.display = "none"; 
            document.body.style.overflow = "auto"; 
            resetZoom();
        }
        document.getElementById('close-modal').onclick = closeModal;
        modal.onclick = (e) => { if(e.target === modal || e.target === modalCont) closeModal(); };

        // Disable Context Menu
        modalImg.addEventListener('contextmenu', e => e.preventDefault());

        // DATA LOADING
        async function loadData(api, gridId, folder) {
            try {
                const res = await fetch(api);
                const items = await res.json();
                const grid = document.getElementById(gridId);
                if (items && items.length > 0) {
                    grid.innerHTML = items.map(item => {
                        const rawPath = item.image_path.startsWith('http') ? item.image_path : `/images/${folder}/${item.image_path}`;
                        return `<img src="${optimizeCloudinary(rawPath, 'thumb')}" alt="${item.name || item.title || 'Untitled'}" onclick="openView('${optimizeCloudinary(rawPath, 'full')}', this.alt)">`;
                    }).join('');
                }
            } catch (err) { console.error(err); }
        }

        window.addEventListener('DOMContentLoaded', () => {
            loadData('/api/personals', 'image-gallery', 'personals');
            loadData('/api/comission_works', 'commission-gallery', 'comission_works');
        });
        const headerBlock = document.querySelector('.section-divider-block');
    
        // Kita pantau posisi elemen terhadap top header (85px di mobile, 110px di desktop)
        window.addEventListener('scroll', () => {
            const stickyPos = headerBlock.getBoundingClientRect().top;
            const offset = window.innerWidth <= 768 ? 85 : 110;

            // Jika posisi elemen <= batas sticky, tambahkan class is-pinned
            if (stickyPos <= offset) {
                headerBlock.classList.add('is-pinned');
            } else {
                headerBlock.classList.remove('is-pinned');
            }
        });
        document.querySelectorAll('.nav-link').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault(); // Mencegah lompatan instan

                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);

                if (targetElement) {
                    // Tentukan offset berdasarkan tinggi header (110px desktop, 85px mobile)
                    const headerOffset = window.innerWidth <= 768 ? 85 : 110;
                    const elementPosition = targetElement.getBoundingClientRect().top + window.scrollY; 
                    const offsetPosition = elementPosition - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });
        const logoToTop = document.getElementById('back-to-top');

        logoToTop.addEventListener('click', function(e) {
            e.preventDefault(); // Mencegah munculnya '#' di URL
            
            window.scrollTo({
                top: 0,
                behavior: 'smooth' // Scroll meluncur halus ke atas
            });
        });
    </script>
</body>
</html>